[gd_scene load_steps=16 format=3 uid="uid://ca8xb1y3t56oq"]

[ext_resource type="Texture2D" uid="uid://n10k0fvcjf5i" path="res://textures/test_cobble.png" id="1_jyhfs"]
[ext_resource type="PackedScene" uid="uid://bljdhvniu6egk" path="res://scenes/player.tscn" id="1_o5qli"]
[ext_resource type="Script" uid="uid://e16yhenlgyiv" path="res://scenes/rotation_coordinator.gd" id="2_0wfyh"]
[ext_resource type="PackedScene" uid="uid://h3k4p0ug3smy" path="res://scenes/test_npc.tscn" id="3_sugp2"]
[ext_resource type="Script" uid="uid://cing1f23rd8f" path="res://scenes/cards/ui_card_game_layer.gd" id="5_85g3d"]
[ext_resource type="Script" uid="uid://clqgq1n7v0ar" path="res://addons/card-framework/card_manager.gd" id="6_tipki"]
[ext_resource type="PackedScene" uid="uid://bmxrc82544a5u" path="res://scenes/cards/custom_json_card_factory.tscn" id="7_85g3d"]
[ext_resource type="Script" uid="uid://6ams8uvg43gu" path="res://addons/card-framework/pile.gd" id="8_choun"]
[ext_resource type="Script" uid="uid://dj46jo3lfbclo" path="res://addons/card-framework/hand.gd" id="9_85g3d"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tbgi4"]
albedo_texture = ExtResource("1_jyhfs")
uv1_scale = Vector3(20, 20, 20)
texture_filter = 0

[sub_resource type="BoxMesh" id="BoxMesh_ya4ey"]
size = Vector3(50, 1, 50)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_o5qli"]
albedo_color = Color(1, 0.564706, 0.133333, 1)

[sub_resource type="BoxMesh" id="BoxMesh_o5qli"]
material = SubResource("StandardMaterial3D_o5qli")
size = Vector3(4, 4, 4)

[sub_resource type="Sky" id="Sky_85g3d"]

[sub_resource type="Environment" id="Environment_o5qli"]
background_energy_multiplier = 7.02
sky = SubResource("Sky_85g3d")
ambient_light_color = Color(0.822481, 0.763441, 0.566739, 1)
ambient_light_energy = 5.28

[node name="Main" type="Node3D"]

[node name="MeshInstance3D" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.0079608, -0.492437, 0.00208569)
material_override = SubResource("StandardMaterial3D_tbgi4")
mesh = SubResource("BoxMesh_ya4ey")

[node name="Player" parent="." instance=ExtResource("1_o5qli")]
unique_name_in_owner = true

[node name="MeshInstance3D2" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -4.89512, 1.63364, 3.24017)
mesh = SubResource("BoxMesh_o5qli")

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_o5qli")

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.81643, 1.9515, 0)
light_energy = 1.822
light_indirect_energy = 1.126
omni_range = 8.187

[node name="RotationCoordinator" type="Node" parent="."]
unique_name_in_owner = true
script = ExtResource("2_0wfyh")
metadata/_custom_type_script = "uid://e16yhenlgyiv"

[node name="TestNPC" parent="." instance=ExtResource("3_sugp2")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 3.82279, 0, 0)

[node name="UICardGameLayer" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("5_85g3d")

[node name="CardManager" type="Control" parent="UICardGameLayer"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("6_tipki")
card_factory_scene = ExtResource("7_85g3d")
metadata/_custom_type_script = "uid://clqgq1n7v0ar"

[node name="PlayerDeck" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.9
anchor_top = 0.8
anchor_right = 0.9
anchor_bottom = 0.8
offset_left = -40.0
offset_top = -40.0
grow_horizontal = 0
grow_vertical = 0
script = ExtResource("8_choun")
card_face_up = false
allow_card_movement = false
metadata/_custom_type_script = "uid://6ams8uvg43gu"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/PlayerDeck"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "P1Deck"

[node name="PlayerHand" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.5
anchor_top = 0.8
anchor_right = 0.5
anchor_bottom = 0.8
offset_left = -20.0
offset_top = -40.0
offset_right = 20.0
grow_horizontal = 2
grow_vertical = 0
script = ExtResource("9_85g3d")
max_hand_size = 100
max_hand_spread = 1400
metadata/_custom_type_script = "uid://dj46jo3lfbclo"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/PlayerHand"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "P1Hand"

[node name="PlayerDiscard" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.1
anchor_top = 0.9
anchor_right = 0.1
anchor_bottom = 0.9
offset_top = -40.0
offset_right = 40.0
grow_vertical = 0
script = ExtResource("8_choun")
metadata/_custom_type_script = "uid://6ams8uvg43gu"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/PlayerDiscard"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Player Discard"

[node name="PlayerField" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.5
anchor_top = 0.6
anchor_right = 0.5
anchor_bottom = 0.6
offset_left = -20.0
offset_top = -20.0
offset_right = 20.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("9_85g3d")
metadata/_custom_type_script = "uid://dj46jo3lfbclo"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/PlayerField"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Player Field"

[node name="OpponentDeck" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.9
anchor_top = 0.1
anchor_right = 0.9
anchor_bottom = 0.1
offset_left = -40.0
offset_bottom = 40.0
grow_horizontal = 0
script = ExtResource("8_choun")
card_face_up = false
metadata/_custom_type_script = "uid://6ams8uvg43gu"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/OpponentDeck"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Opponent Deck"

[node name="OpponentHand" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.5
anchor_top = 0.1
anchor_right = 0.5
anchor_bottom = 0.1
offset_left = -20.0
offset_right = 20.0
offset_bottom = 40.0
grow_horizontal = 2
script = ExtResource("9_85g3d")
card_face_up = false
metadata/_custom_type_script = "uid://dj46jo3lfbclo"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/OpponentHand"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Opponent Hand"

[node name="OpponentDiscard" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.1
anchor_top = 0.1
anchor_right = 0.1
anchor_bottom = 0.1
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("8_choun")
metadata/_custom_type_script = "uid://6ams8uvg43gu"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/OpponentDiscard"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Opponent Discard"

[node name="OpponentField" type="Control" parent="UICardGameLayer/CardManager"]
layout_mode = 1
anchor_left = 0.5
anchor_top = 0.3
anchor_right = 0.5
anchor_bottom = 0.3
offset_left = -20.0
offset_top = -20.0
offset_right = 20.0
offset_bottom = 20.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("9_85g3d")
metadata/_custom_type_script = "uid://dj46jo3lfbclo"

[node name="Label" type="Label" parent="UICardGameLayer/CardManager/OpponentField"]
layout_mode = 0
offset_right = 40.0
offset_bottom = 23.0
text = "Opponent Field"

[node name="Button" type="Button" parent="UICardGameLayer"]
layout_mode = 0
offset_right = 8.0
offset_bottom = 8.0
text = "Press to draw 7"

[connection signal="camera_rotate" from="Player" to="RotationCoordinator" method="_on_player_camera_rotate"]
[connection signal="pressed" from="UICardGameLayer/Button" to="UICardGameLayer" method="_on_button_pressed"]
